<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Shor&rsquo;s Algorithm</title>
<link rel=preconnect href="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=720&amp;q=80"><link rel=dns-prefetch href="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=720&amp;q=80"><link rel=preload href="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=720&amp;q=80" as=image><link rel=preload href=https://aben20807.github.io/css/tachyons.min.css?1745934155 as=style><link rel=preload href=https://aben20807.github.io/css/hugouo.css?1745934155 as=style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload href=https://fonts.googleapis.com/earlyaccess/notosanstc.css as=style><link rel=preload href=https://fonts.gstatic.com/ea/notosanstc/v1/NotoSansTC-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preconnect href=https://use.fontawesome.com crossorigin><link rel=preload href=https://aben20807.github.io/js/hugouo.js?1745934155 as=script><link rel=preconnect href=https://lh3.googleusercontent.com crossorigin><link rel=alternate type=application/rss+xml title=RSS href=https://aben20807.github.io/index.xml><link rel=canonical href=https://aben20807.github.io/posts/20220626-shor-algorithm/><link rel="shortcut icon" type=image/png href=https://aben20807.github.io/apple-touch-icon-precomposed.png><meta name=description content="記錄所見所聞，涵蓋電腦科學、資訊工程與日常生活。Documenting observations and experiences, encompassing computer science, information engineering, and everyday life."><meta name=generator content="Hugo 0.147.0"><meta name=og:title content="Shor&rsquo;s Algorithm"><meta name=og:type content="article"><meta name=og:image content="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=720&amp;q=80"><meta name=og:description content="Shor&rsquo;s Algorithm explanation with examples"><meta name=og:url content="https://aben20807.github.io/posts/20220626-shor-algorithm/"><meta name=og:site_name content="記錄用"><meta name=keywords content="qft,ibm,quantum,qpe,shor"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@aben20807_web"><script src=https://cdn.jsdelivr.net/npm/fetch-inject@2.0.4/dist/fetch-inject.umd.min.js integrity="sha256-paKBtnIrL5ClLfBOtgxh1UqYCjL9790IRvDOnBh2LyI=" crossorigin=anonymous></script><link rel=stylesheet href=https://aben20807.github.io/css/tachyons.min.css async><link rel=stylesheet href=https://aben20807.github.io/css/hugouo.css?1745934155 async><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous async><link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC:400,400i&amp;subset=latin-ext" rel=stylesheet async><script async src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.1/lazysizes.min.js></script><noscript><style type=text/css>.lazyload{display:none}</style></noscript><script async src=https://cdn.jsdelivr.net/npm/js-base64@3.7.7/base64.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-TCW0ZKBVFW"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TCW0ZKBVFW")}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8075275543045163" crossorigin=anonymous></script><meta name=referrer content="no-referrer"><meta name=robots content="index,follow"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"></head><body class="ma0 bg-main section-posts page-kind-page is-page-true"><header class="cover bg-top" style="background-image:url(https://images.unsplash.com/photo-1462331940025-496dfbfc7564?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=720&amp;q=80);background-position:50%"><div class=bg-black-60><nav class="hide-print sans-serif border-box pa3 ph5-l"><a href=https://aben20807.github.io/ title=Home><img src=https://aben20807.github.io/img/logo.jpg class="w2 h2 br-100" alt=記錄用></a><div class="fr h2 pv2 tr" id=menu-bar><a class="link f4 ml2 dim near-white no-underline-on-hover" href=/categories/>分類</a><div class=subnav><span class="link f4 ml2 dim h-100 near-white no-underline-on-hover">More <i class="fa fa-caret-down"></i></span><div class=subnav-content><a class="link f4 ml2 dim ml2 w-100 dim near-white no-underline-on-hover" href=/tags/>標籤</a>
<a class="link f4 ml2 dim ml2 w-100 dim near-white no-underline-on-hover" href=/series/>系列</a>
<a class="link f4 ml2 dim ml2 w-100 dim near-white no-underline-on-hover" href=/archives/>歸檔</a>
<a class="link f4 ml2 dim ml2 w-100 dim near-white no-underline-on-hover" href=/note/>Note</a>
<a class="link f4 ml2 dim ml2 w-100 dim near-white no-underline-on-hover" href=/anime/>Anime</a>
<a class="link f4 ml2 dim ml2 w-100 dim near-white no-underline-on-hover" href=https://github.com/aben20807/blog-post-issues/issues target=_blank rel="noreferrer noopener">GitHub</a></div></div><a class="link f4 ml2 dim near-white no-underline-on-hover" href=/about>關於</a>
<a class="link f4 ml2 dim near-white fas fa-rss-square no-underline-on-hover" href=https://aben20807.github.io/index.xml title="RSS Feed"></a><a class="link f4 ml2 dim near-white fas fa-envelope no-underline-on-hover" href=https://aben20807.github.io/subscription/ role=button title=Subscription></a><a class="link f4 ml2 dim near-white fas fa-coffee no-underline-on-hover" href=https://www.buymeacoffee.com/aben20807 target=_blank title="Buy me a coffee"></a><a class="link f4 ml2 dim near-white fas fa-search no-underline-on-hover" href=https://aben20807.github.io/search/ title=Search></a><div class="js-toggle-wrapper f5 ml1" title="light-dark theme switch"><div class=js-toggle><div class=js-toggle-track><div class=js-toggle-track-check><img src="data:image/png;base64,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" role=presentation style=pointer-events:none width=16 height=16></div><div class=js-toggle-track-x><img src="data:image/png;base64,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" role=presentation style=pointer-events:none width=16 height=16></div></div><div class=js-toggle-thumb></div><input class=js-toggle-screenreader-only type=checkbox aria-label="Switch between Dark and Light mode"></div></div><style>.js-toggle-wrapper{display:inline;width:fit-content}.js-toggle{touch-action:pan-x;display:inline-block;position:relative;cursor:pointer;background-color:transparent;border:0;padding:0;-webkit-touch-callout:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-tap-highlight-color:transparent}.js-toggle-screenreader-only{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.js-toggle-track{width:2rem;height:.95rem;padding:0;border-radius:1.3rem;background-color:#0f1114;transition:all .2s ease}.js-toggle-track-check{position:absolute;width:.7rem;height:.7rem;left:.2rem;top:0;bottom:0;margin-top:auto;margin-bottom:auto;line-height:0;opacity:0;transition:opacity .25s ease}.js-toggle--checked .js-toggle-track-check{opacity:1;transition:opacity .25s ease}.js-toggle-track-x{position:absolute;width:.7rem;height:.7rem;right:.2rem;top:0;bottom:0;margin-top:auto;margin-bottom:auto;line-height:0;opacity:1;transition:opacity .25s ease}.js-toggle--checked .js-toggle-track-x{opacity:0}.js-toggle-thumb{position:absolute;top:.03rem;left:.03rem;width:.9rem;height:.9rem;border-radius:50%;background-color:#fafafa;box-sizing:border-box;transition:all .5s cubic-bezier(.23,1,.32,1)0ms;transform:translateX(0)}.js-toggle--checked .js-toggle-thumb{transform:translateX(1.05rem);border-color:#19ab27}.js-toggle--focus .js-toggle-thumb{box-shadow:0 0 2px 3px #ffa7c4}.js-toggle:active .js-toggle-thumb{box-shadow:0 0 5px 5px #ffa7c4}</style><script>var body=document.body,switcher=document.getElementsByClassName("js-toggle")[0];switcher.addEventListener("click",function(){this.classList.toggle("js-toggle--checked"),this.classList.add("js-toggle--focus"),this.classList.contains("js-toggle--checked")?(body.classList.add("dark-mode"),localStorage.setItem("darkMode","true")):(body.classList.remove("dark-mode"),setTimeout(function(){localStorage.removeItem("darkMode")},100))}),localStorage.getItem("darkMode")&&(switcher.classList.add("js-toggle--checked"),body.classList.add("dark-mode"))</script></div></nav><div id=hdr class="tc-l pv4-ns pv5-l pv2 ph3 ph4-ns"><h1 class="near-white mt1-ns f2 fw3 pt5 mb0 mt0 lh-title serif">Shor&rsquo;s Algorithm</h1><h2 class="near-white mt3-l mb4-l fw1 f6 f3-l measure-wide-l center lh-copy mt2 mb3 serif">Published
<time datetime=2022-06-29T13:58:58+08:00>Jun 29, 2022</time>
<span class=display-print>by Huang, Po-Hsuan 黃柏瑄 (aben20807)</span>
in <a href=https://aben20807.github.io/categories/%E9%87%8F%E5%AD%90%E9%81%8B%E7%AE%97 class="no-underline category title-link near-white dim">量子運算</a>
<span class=display-print>at <a href=https://aben20807.github.io/posts/20220626-shor-algorithm/>https://aben20807.github.io/posts/20220626-shor-algorithm/</a></span></h2><h6 class="near-white fw1 f6 f5-l measure-wide-l center lh-copy hide-print serif"><span title="Word count: 3282 words"><i class="far fa-file-alt"></i></i> 3282 words</span> <span title="Reading time: 15 minutes"><i class="far fa-clock"></i> 15 minutes</span></h6></div><div class="w-100 cf hide-print"><a class="fr f6 ma0 pa2 link white-50 dim fas fa-camera" href=https://unsplash.com/photos/rTZW4f02zY8 title="Photo Credit" target=_blank rel="noreferrer noopener"></a></div></div></header><main role=main><div class="row bg-main"><div id=toc class="column col-2 hide-print"></div><div class="column col-1 printable"><article class="center bg-main br-3 pv1 ph4 lh-copy f5" style=max-width:48rem><div class=pb4-ns><div class=row><div class=col-md-8><div class=mb-5><div class="li-x div-x post-meta"><li class=pr-0><a href=https://aben20807.github.io/tags/ style=border:0><i class="fas fa-tags"></i></a></li><span class=tags-sm><li><a href=https://aben20807.github.io/tags/qft role=button class="no-underline no-underline-on-hover">qft</a></li><li><a href=https://aben20807.github.io/tags/ibm role=button class="no-underline no-underline-on-hover">ibm</a></li><li><a href=https://aben20807.github.io/tags/quantum role=button class="no-underline no-underline-on-hover">quantum</a></li><li><a href=https://aben20807.github.io/tags/qpe role=button class="no-underline no-underline-on-hover">qpe</a></li><li><a href=https://aben20807.github.io/tags/shor role=button class="no-underline no-underline-on-hover">shor</a></li></span></div></div></div></div><div class=row><div class=col-md-8></div></div></div><p>利用量子特性來質因數分解。</p><p>有錯再麻煩指正，感謝。</p><h1 id=目標問題 class="article-heading serif">目標問題
<a class="headline-hash smoothScroll hover-show scrollspy" href=#%e7%9b%ae%e6%a8%99%e5%95%8f%e9%a1%8c><i class="fas fa-hashtag fa-xs"></i></a></h1><p>RSA 是一種常見的加密演算法，使用的是非對稱加密演算法，其中會利用到兩個極大質數相乘，因此 RSA 的可靠度建立於對極大整數因數分解的難度。</p><h2 id=example-ref class="article-heading serif">Example <a href=https://www.cs.jhu.edu/~yairamir/cs437/week12/sld015.htm title=ref aria-label=ref target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> ref</a>
<a class="headline-hash smoothScroll hover-show scrollspy" href=#example-ref><i class="fas fa-hashtag fa-xs"></i></a></h2><ul><li>Generate keys:<ul><li>Pick two prime numbers $P, Q$, e.g., $P = 5, Q = 11$</li><li>$N = P\times Q = 55$</li><li>$Z = (P-1)\times(Q-1) = 40$</li><li>Pick $e$ such that $\gcd(e, Z) = 1$, e.g., $e = 13$</li><li>Pick $d$ such that $e\times d\equiv1(\text{mod }Z)$, e.g., $d = 37$</li><li>$\Rightarrow$ Public key: $(e, N)$; Private key: $(d, N)$</li></ul></li><li>Usage:<ul><li>Encrypt: $E = M^e(\text{mod }N)\Rightarrow E = M^{13}(\text{mod }55)$</li><li>Decrypt: $M = E^d(\text{mod }N)\Rightarrow M = E^{37}(\text{mod }55)$</li></ul></li></ul><h1 id=several-lemmas-with-examples class="article-heading serif">Several lemmas with examples
<a class="headline-hash smoothScroll hover-show scrollspy" href=#several-lemmas-with-examples><i class="fas fa-hashtag fa-xs"></i></a></h1><p>這邊使用了比較直觀會用到的 Lemma，且使用範例當作說明，不使用證明。</p><div class=alert-block><div class="alert-title info-title"><i class="fa fa-info-circle pr2"></i></div><div class="alert-msg info-msg db overflow-x-scroll ov-for-img"><p>Lemma 1:<br>$g^2\equiv1(\text{mod }N), 1&lt;g&lt;N-1\Rightarrow$<br>$\gcd(N, g-1)\mid N \text{ or }\gcd(N, g+1)\mid N$</p></div></div><ul><li><p>Example 1: $N = 15$<br>$4^2\equiv 1(\text{mod }15), \gcd(15, 3) = 3\mid 15, \gcd(15, 5) = 5 \mid 15$</p></li><li><p>Example 2: $N = 21$<br>$8^2\equiv 1(\text{mod }21), \gcd(21, 7) = 7\mid 21, \gcd(21, 9) = 3 \mid 21$</p></li></ul><div class=alert-block><div class="alert-title info-title"><i class="fa fa-info-circle pr2"></i></div><div class="alert-msg info-msg db overflow-x-scroll ov-for-img"><p>Lemma 2:<br>$g^x\equiv1(\text{mod }N), 2\mid x, g^{\frac{x}{2}}\not\equiv1(\text{mod }N)\Rightarrow$<br>$(g^{\frac{x}{2}})^2\equiv1(\text{mod }N), g^{\frac{x}{2}}\not\equiv 1(\text{mod }N) \text{, and }g^{\frac{x}{2}}\not\equiv N-1(\text{mod }N)<br>\Rightarrow$<br>$\gcd(N, g^{\frac{x}{2}}-1)\mid N \text{ or }\gcd(N, g^{\frac{x}{2}}+1)\mid N$</p></div></div><ul><li><p>Example 1: $N = 15$<br>$2^4\equiv 1(\text{mod }N), \gcd(15, 3) = 3\mid 15, \gcd(15, 5) = 5 \mid 15$</p></li><li><p>Example 2: $N = 21$<br>$2^6\equiv 1(\text{mod }N), \gcd(21, 7) = 7\mid 21, \gcd(21, 9) = 3 \mid 21$</p></li></ul><div class=alert-block><div class="alert-title info-title"><i class="fa fa-info-circle pr2"></i></div><div class="alert-msg info-msg db overflow-x-scroll ov-for-img"><p>Lemma 3:<br>$g^p\equiv 1(\text{mod }N)\Rightarrow$<br>$g^x\equiv g^{x+np}(\text{mod }N), n \in\mathbb{N}$</p></div></div><ul><li>Example: $N = 15, g = 2$<br>$2^1\equiv 2^5\equiv 2^9\equiv 2(\text{mod }15); 2^2\equiv 2^6\equiv 2^{10}\equiv 4(\text{mod }15)$<br>$\Rightarrow p = 4\Rightarrow 2^4\equiv 1(\text{mod }15)$</li><li>Example: $N = 15, g = 7$<br>$7^1\equiv 7^5\equiv 7^9\equiv 7(\text{mod }15); 7^2\equiv 7^6\equiv 7^{10}\equiv 4(\text{mod }15)$<br>$\Rightarrow p = 4\Rightarrow 2^4\equiv 1(\text{mod }15)$</li></ul><h1 id=solving-by-quantum class="article-heading serif">Solving by Quantum
<a class="headline-hash smoothScroll hover-show scrollspy" href=#solving-by-quantum><i class="fas fa-hashtag fa-xs"></i></a></h1><p>加速效果 (對 $N$ 作質因數分解):</p><ul><li>古典最佳: $O(e^{1.9(\log N)^{1/3}(\log\log N)^{2/3}})$ is <a href=https://en.wikipedia.org/wiki/Sub-exponential_time title="sub-exponential time" aria-label="sub-exponential time" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> sub-exponential time</a></li><li>Shor&rsquo;s algorithm: $O((\log N)^2(\log\log N)(\log\log\log N))$ is <a href=https://en.wikipedia.org/wiki/Polynomial_time title="polynomial time" aria-label="polynomial time" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> polynomial time</a></li></ul><h2 id=convert-to-u class="article-heading serif">Convert to $U$
<a class="headline-hash smoothScroll hover-show scrollspy" href=#convert-to-u><i class="fas fa-hashtag fa-xs"></i></a></h2><p>$f(x) = g^x (\text{mod } N)$, where $g, N\in\mathbb{Z}, g &lt; N$, and $\gcd(g, N) = 1$<br>$g^r \equiv 1 (\text{mod } N)$<br>$U\lvert y\rangle\equiv \lvert g y (\text{mod } N)\rangle$<br>$U^k\lvert y\rangle\equiv \lvert g^ky (\text{mod } N)\rangle, 0\le k$</p><ul><li>Example: $N = 15, g = 7$<ul><li>$U^0\lvert 1\rangle = \lvert 1\rangle$</li><li>$U^1\lvert 1\rangle = \lvert 7\rangle$</li><li>$U^2\lvert 1\rangle = \lvert 4\rangle$</li><li>$U^3\lvert 1\rangle = \lvert 13\rangle$</li><li>$U^4\lvert 1\rangle = U^r\lvert 1\rangle = \lvert 1\rangle$</li><li>$U^5\lvert 1\rangle = \lvert 7\rangle$</li></ul></li></ul><h2 id=eigenvector class="article-heading serif">Eigenvector
<a class="headline-hash smoothScroll hover-show scrollspy" href=#eigenvector><i class="fas fa-hashtag fa-xs"></i></a></h2><p>$$\lvert \mu_s\rangle = \frac{1}{\sqrt{r}}\sum_{k = 0}^{r-1}<br>e^{-\frac{2\pi i s k}{r}}\lvert g^k (\text{mod } N)\rangle, 0\le s &lt; r<br>$$</p><p>$$U\lvert \mu_s\rangle = e^{\frac{2\pi i s}{r}}\lvert \mu_s\rangle$$</p><p>則 eigenvalue 可推得為 $e^{\frac{2\pi i s}{r}}$，再經過 IQFT 將相位資訊提出，可得 $\varphi = \frac{s}{r}$。</p><ul><li>Example: $N = 15, g = 7$<ul><li>$\lvert \mu_0\rangle = \frac{1}{2}(\lvert 1\rangle+\qquad\lvert 7\rangle+\qquad<br>\lvert 4\rangle+\qquad<br>\lvert 13\rangle)$</li><li>$\lvert \mu_1\rangle = \frac{1}{2}(\lvert 1\rangle+e^{-\frac{2\pi i}{4}}\lvert 7\rangle+e^{-\frac{4\pi i}{4}}<br>\lvert 4\rangle+e^{-\frac{6\pi i}{4}}<br>\lvert 13\rangle)$</li><li>$\lvert \mu_2\rangle = \frac{1}{2}(\lvert 1\rangle+e^{-\frac{4\pi i}{4}}<br>\lvert 7\rangle+e^{-\frac{8\pi i}{4}}<br>\lvert 4\rangle+e^{-\frac{12\pi i}{4}}<br>\lvert 13\rangle)$</li><li>$\lvert \mu_3\rangle = \frac{1}{2}(\lvert 1\rangle+e^{-\frac{6\pi i}{4}}<br>\lvert 7\rangle+e^{-\frac{12\pi i}{4}}<br>\lvert 4\rangle+e^{-\frac{18\pi i}{4}}<br>\lvert 13\rangle)$</li></ul></li></ul><h2 id=eigenvectors-superposition class="article-heading serif">Eigenvectors superposition
<a class="headline-hash smoothScroll hover-show scrollspy" href=#eigenvectors-superposition><i class="fas fa-hashtag fa-xs"></i></a></h2><p>$$\frac{1}{\sqrt{r}}\sum_{s = 0}^{r-1}\lvert \mu_s\rangle = \lvert 1\rangle<br>$$</p><ul><li>Example: $N = 15, g = 7$</li></ul><p>$$\frac{1}{\sqrt{r}}\sum_{s = 0}^{r-1}\lvert \mu_s\rangle =\lvert \mu_0\rangle +\lvert \mu_1\rangle+\lvert \mu_2\rangle+\lvert \mu_3\rangle<br>=\lvert 1\rangle$$</p><h2 id=use-qpe-to-get-eigenvalue class="article-heading serif">Use QPE to get eigenvalue
<a class="headline-hash smoothScroll hover-show scrollspy" href=#use-qpe-to-get-eigenvalue><i class="fas fa-hashtag fa-xs"></i></a></h2><p>Eigenvector 輸入使用疊加態 (參考上一篇文章)。輸出時就有這些可能: $\lvert 2^t\frac{0}{r}\rangle,\lvert 2^t\frac{1}{r}\rangle,&mldr;, \lvert 2^t\frac{r-1}{r}\rangle$ 共 $r$ 種，$2^t$ 可以看作將小數變為整數的 scaling factor 表達時可以將其轉換成小數的表達方法即可，因此就可以透過統計的方式找出所求 $r$。另外可以看到 $\frac{0}{r} = 0$ 無法得知 $r$ 的資訊，因此有 $\frac{1}{r}$ 的機率會猜到 $0$ 進而無法推算出 $r$。</p><p><figure class="gphoto-media center"><div class="img-container center"><noscript><img src=https://lh3.googleusercontent.com/d/1iSt8-MEtjJxCcTK6Ckk1AuMNqUDQxpN4 oncontextmenu=return!1 class="center img-zoomable" alt='Shor&rsquo;s algorithm 示意圖; CC BY 4.0 Huang, Po-Hsuan' data-action=zoom title='Shor&rsquo;s algorithm 示意圖; CC BY 4.0 Huang, Po-Hsuan'></noscript><img data-src=https://lh3.googleusercontent.com/d/1iSt8-MEtjJxCcTK6Ckk1AuMNqUDQxpN4 oncontextmenu=return!1 class="center img-zoomable lazyload" alt='Shor&rsquo;s algorithm 示意圖; CC BY 4.0 Huang, Po-Hsuan' style=display:block width=400 data-action=zoom title='Shor&rsquo;s algorithm 示意圖; CC BY 4.0 Huang, Po-Hsuan'></div><figcaption class=center style=max-width:400px><center class=caption-text style="margin:0 .3rem"><p style="margin:.5rem 0 0">Shor&rsquo;s algorithm 示意圖; <a href=/posts/20220626-shor-algorithm/ title="CC BY 4.0 Huang, Po-Hsuan" aria-label="CC BY 4.0 Huang, Po-Hsuan">CC BY 4.0 Huang, Po-Hsuan</a></p><font class="douyin hover-show"><a href=https://lh3.googleusercontent.com/d/1iSt8-MEtjJxCcTK6Ckk1AuMNqUDQxpN4 target=_blank rel="noreferrer noopener" style=opacity:1;text-decoration:none>OuO</a></font></center></figcaption></figure></p><p>以上就是利用量子來解決質因數分解的方法。再來進入實作部分。</p><h1 id=qiskit-implementation class="article-heading serif">Qiskit implementation
<a class="headline-hash smoothScroll hover-show scrollspy" href=#qiskit-implementation><i class="fas fa-hashtag fa-xs"></i></a></h1><p>因為程式已經大到我用 IBM Composer 無法簡單實作了，所以這邊改使用 IBM Qiskit 這個量子 python 工具以及從官方的範例 <a href=https://qiskit.org/textbook/ch-algorithms/shor.html title="Shor&rsquo;s Algorithm - IBM" aria-label="Shor&rsquo;s Algorithm - IBM" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> Shor&rsquo;s Algorithm - IBM</a> / <a href=https://github.com/qiskit-community/qiskit-textbook/blob/main/content/ch-algorithms/shor.ipynb title=src aria-label=src target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> src</a> 下去修改。並且由於 Qubit 數量已經超過官方提供的 5 位，因此先使用模擬器來進行運算。</p><p>差異性: 官方使用的 counting bit 數量是 8-bit (原始版 Shor&rsquo;s algorithm 需要兩個 register，一個, counting bit, 是 $2n$ bits，另一個, eigenvector, 是 $n$ bits，$n = \log N$。因為 $15$ 是 4-bit 整數，所以 counting bit 使用 8 位)。不過理論上 2-bit 就可以重現結果，但本篇為了說明大部分使用 4-bit。另外一些變數跟函式命名方式有針對本文所使用的符號進行修改。官方在 counting bit 使用 Little Endian 但 $U$ 的運算使用 Big Endian，本篇統一使用 Little Endian (高記憶體位置放 MSB)。</p><p>電路架構:</p><ol><li>U circuit: 實作 $g^x (\text{mod } N)$</li><li>IQFT</li><li>QPE: 包含對 t-bit counting bits 做疊加以及 1. 2.</li></ol><p><figure class="gphoto-media center"><div class="img-container center"><noscript><img src=https://lh3.googleusercontent.com/d/12rzzidlj5xDKRNDayv11FgIVQGvVKI2K oncontextmenu=return!1 class="center img-zoomable" alt='High-level 量子電路圖' data-action=zoom title='High-level 量子電路圖'></noscript><img data-src=https://lh3.googleusercontent.com/d/12rzzidlj5xDKRNDayv11FgIVQGvVKI2K oncontextmenu=return!1 class="center img-zoomable lazyload" alt='High-level 量子電路圖' style=display:block width=400 data-action=zoom title='High-level 量子電路圖'></div><figcaption class=center style=max-width:400px><center class=caption-text style="margin:0 .3rem"><p style="margin:.5rem 0 0">High-level 量子電路圖</p><font class="douyin hover-show"><a href=https://lh3.googleusercontent.com/d/12rzzidlj5xDKRNDayv11FgIVQGvVKI2K target=_blank rel="noreferrer noopener" style=opacity:1;text-decoration:none>OuO</a></font></center></figcaption></figure></p><h2 id=u-circuit class="article-heading serif">U circuit
<a class="headline-hash smoothScroll hover-show scrollspy" href=#u-circuit><i class="fas fa-hashtag fa-xs"></i></a></h2><p>這個 circuit 是我個人認為最複雜的區塊，因為它似乎沒有一個直觀的建立方法，且隨著 $g$ 或 $N$ 不一樣就需要重新建立，因此不太像一般古典運算的函式一樣可以修改輸入的變數即可。U circuit 要做的事就是產生一個 $g^x (\text{mod } N)$ 其中 $x$ 隨著 $t$ 增加而增加。為何這邊的 $U$ 需要使用 4-bit，原因是 $\text{mod } 15$ ($0, 1, &mldr;, 14$) 的所有數字需要用 4-bit 表示。</p><p>另外可以看到這裡的 <code>gmod15_circ</code> 是比較一般化 (general) 的形式，可以同時支援不同的 $g$ 作為輸入，不過仍是需要重新產生不同的電路。有趣的是根據設計可以發現在 $g = 4$ 時可以用到最少的邏輯閘 (只需要 2 個 CSWAP<sup id=fnref:1 class=footnote-ref-wrapper><a href=#fn:1 class="footnote-ref smoothScroll no-underline-on-hover" role=doc-noteref>1</a></sup> 也就是 6 個 CCX<sup id=fnref:2 class=footnote-ref-wrapper><a href=#fn:2 class="footnote-ref smoothScroll no-underline-on-hover" role=doc-noteref>2</a></sup>)。</p><p>這裡以 $t = 2$ (counting bit: $c[0], c[1]$), $g = 7$ 為例 (因為 counting bit 兩位就足夠)，真值表可寫成下方表格。$[i]$ 表示二進位第 $i$ 位。請搭配下方圖片查看中間結果。</p><table><thead><tr><th style=text-align:center>$c[1]$</th><th style=text-align:center>$c[0]$</th><th style=text-align:center>$\mu[3]$</th><th style=text-align:center>$\mu[2]$</th><th style=text-align:center>$\mu[1]$</th><th style=text-align:center>$\mu[0]$</th><th style=text-align:center>$\mu$</th></tr></thead><tbody><tr><td style=text-align:center>$0$</td><td style=text-align:center>${\color{red}0}$</td><td style=text-align:center>${\color{red}0}$</td><td style=text-align:center>${\color{red}0}$</td><td style=text-align:center>${\color{red}0}$</td><td style=text-align:center>${\color{red}1}$</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>$0$</td><td style=text-align:center>${\color{blue}1}$</td><td style=text-align:center>${\color{blue}0}$</td><td style=text-align:center>${\color{blue}1}$</td><td style=text-align:center>${\color{blue}1}$</td><td style=text-align:center>${\color{blue}1}$</td><td style=text-align:center>7</td></tr><tr><td style=text-align:center>$\fcolorbox{green}{}1$</td><td style=text-align:center>$0$</td><td style=text-align:center>${\color{red}\fcolorbox{green}{}0}$</td><td style=text-align:center>${\color{red}\fcolorbox{green}{}1}$</td><td style=text-align:center>${\color{red}\fcolorbox{green}{}0}$</td><td style=text-align:center>${\color{red}\fcolorbox{green}{}0}$</td><td style=text-align:center>4</td></tr><tr><td style=text-align:center>$\fcolorbox{green}{}1$</td><td style=text-align:center>$1$</td><td style=text-align:center>${\color{blue}\fcolorbox{green}{}1}$</td><td style=text-align:center>${\color{blue}\fcolorbox{green}{}1}$</td><td style=text-align:center>${\color{blue}\fcolorbox{green}{}0}$</td><td style=text-align:center>${\color{blue}\fcolorbox{green}{}1}$</td><td style=text-align:center>13</td></tr></tbody></table><p><figure class="gphoto-media center"><div class="img-container center"><noscript><img src=https://lh3.googleusercontent.com/d/1o02j6pVqy661y1WKUO4RhEM0SWosoXIV oncontextmenu=return!1 class="center img-zoomable" alt='t = 2, First U; CC BY 4.0 Huang, Po-Hsuan' data-action=zoom title='t = 2, First U; CC BY 4.0 Huang, Po-Hsuan'></noscript><img data-src=https://lh3.googleusercontent.com/d/1o02j6pVqy661y1WKUO4RhEM0SWosoXIV oncontextmenu=return!1 class="center img-zoomable lazyload" alt='t = 2, First U; CC BY 4.0 Huang, Po-Hsuan' style=display:block width=400 data-action=zoom title='t = 2, First U; CC BY 4.0 Huang, Po-Hsuan'></div><figcaption class=center style=max-width:400px><center class=caption-text style="margin:0 .3rem"><p style="margin:.5rem 0 0">t = 2, First U; <a href=/posts/20220626-shor-algorithm/ title="CC BY 4.0 Huang, Po-Hsuan" aria-label="CC BY 4.0 Huang, Po-Hsuan">CC BY 4.0 Huang, Po-Hsuan</a></p><font class="douyin hover-show"><a href=https://lh3.googleusercontent.com/d/1o02j6pVqy661y1WKUO4RhEM0SWosoXIV target=_blank rel="noreferrer noopener" style=opacity:1;text-decoration:none>OuO</a></font></center></figcaption></figure></p><p><figure class="gphoto-media center"><div class="img-container center"><noscript><img src=https://lh3.googleusercontent.com/d/1CpULjzBCd0qbJszRi-RRRgLzS3HBxccL oncontextmenu=return!1 class="center img-zoomable" alt='t = 2, Second U; CC BY 4.0 Huang, Po-Hsuan' data-action=zoom title='t = 2, Second U; CC BY 4.0 Huang, Po-Hsuan'></noscript><img data-src=https://lh3.googleusercontent.com/d/1CpULjzBCd0qbJszRi-RRRgLzS3HBxccL oncontextmenu=return!1 class="center img-zoomable lazyload" alt='t = 2, Second U; CC BY 4.0 Huang, Po-Hsuan' style=display:block width=400 data-action=zoom title='t = 2, Second U; CC BY 4.0 Huang, Po-Hsuan'></div><figcaption class=center style=max-width:400px><center class=caption-text style="margin:0 .3rem"><p style="margin:.5rem 0 0">t = 2, Second U; <a href=/posts/20220626-shor-algorithm/ title="CC BY 4.0 Huang, Po-Hsuan" aria-label="CC BY 4.0 Huang, Po-Hsuan">CC BY 4.0 Huang, Po-Hsuan</a></p><font class="douyin hover-show"><a href=https://lh3.googleusercontent.com/d/1CpULjzBCd0qbJszRi-RRRgLzS3HBxccL target=_blank rel="noreferrer noopener" style=opacity:1;text-decoration:none>OuO</a></font></center></figcaption></figure></p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-35>35</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>gmod15_circ</span>(g, power):
</span></span><span style=display:flex><span>    <span style=color:#b8bb26>&#34;&#34;&#34;Controlled multiplication by g mod 15&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>if</span> g <span style=color:#fe8019>not</span> <span style=color:#fe8019>in</span> [<span style=color:#d3869b>2</span>, <span style=color:#d3869b>4</span>, <span style=color:#d3869b>7</span>, <span style=color:#d3869b>8</span>, <span style=color:#d3869b>11</span>, <span style=color:#d3869b>13</span>]:
</span></span><span style=display:flex><span>        <span style=color:#fe8019>raise</span> <span style=color:#fb4934>ValueError</span>(<span style=color:#b8bb26>&#34;&#39;g&#39; must be 2,4,7,8,11 or 13&#34;</span>)
</span></span><span style=display:flex><span>    U <span style=color:#fe8019>=</span> QuantumCircuit(<span style=color:#d3869b>4</span>)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> _ <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(power):
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> g <span style=color:#fe8019>in</span> [<span style=color:#d3869b>2</span>,<span style=color:#d3869b>13</span>]:
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>0</span>,<span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>1</span>,<span style=color:#d3869b>2</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>2</span>,<span style=color:#d3869b>3</span>)
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> g <span style=color:#fe8019>in</span> [<span style=color:#d3869b>7</span>,<span style=color:#d3869b>8</span>]:
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>2</span>,<span style=color:#d3869b>3</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>1</span>,<span style=color:#d3869b>2</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>0</span>,<span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> g <span style=color:#fe8019>in</span> [<span style=color:#d3869b>4</span>, <span style=color:#d3869b>11</span>]:
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>1</span>,<span style=color:#d3869b>3</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>0</span>,<span style=color:#d3869b>2</span>)
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> g <span style=color:#fe8019>in</span> [<span style=color:#d3869b>7</span>, <span style=color:#d3869b>11</span>, <span style=color:#d3869b>13</span>]:
</span></span><span style=display:flex><span>            <span style=color:#fe8019>for</span> q <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(<span style=color:#d3869b>4</span>):
</span></span><span style=display:flex><span>                U<span style=color:#fe8019>.</span>x(q)
</span></span><span style=display:flex><span>    U <span style=color:#fe8019>=</span> U<span style=color:#fe8019>.</span>reverse_bits() <span style=color:#928374;font-style:italic># reversed because IBM uses Big endian for U</span>
</span></span><span style=display:flex><span>    U <span style=color:#fe8019>=</span> U<span style=color:#fe8019>.</span>to_gate()
</span></span><span style=display:flex><span>    U<span style=color:#fe8019>.</span>name <span style=color:#fe8019>=</span> <span style=color:#b8bb26>f</span><span style=color:#b8bb26>&#34;</span><span style=color:#b8bb26>{</span>g<span style=color:#b8bb26>}</span><span style=color:#b8bb26>^</span><span style=color:#b8bb26>{{</span><span style=color:#b8bb26>2^</span><span style=color:#b8bb26>{</span>log2(power)<span style=color:#b8bb26>:</span><span style=color:#b8bb26>.0f</span><span style=color:#b8bb26>}}</span><span style=color:#b8bb26>}</span><span style=color:#b8bb26> mod 15&#34;</span>
</span></span><span style=display:flex><span>    c_U <span style=color:#fe8019>=</span> U<span style=color:#fe8019>.</span>control()
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> c_U
</span></span></code></pre></td></tr></table></div></div><h2 id=iqft class="article-heading serif">IQFT
<a class="headline-hash smoothScroll hover-show scrollspy" href=#iqft><i class="fas fa-hashtag fa-xs"></i></a></h2><p>這部份我們之前討論過 (請參考前幾篇文章)，所以很容易可以實現。有兩種實作方式，IBM 這裡採用 SWAP 在前的版本。</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-48>48</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>iqft_circ</span>(n):
</span></span><span style=display:flex><span>    <span style=color:#b8bb26>&#34;&#34;&#34;n-qubit QFTdagger (IQFT) the first n qubits in circ&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    qc <span style=color:#fe8019>=</span> QuantumCircuit(n)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> qubit <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(n <span style=color:#fe8019>//</span> <span style=color:#d3869b>2</span>):
</span></span><span style=display:flex><span>        qc<span style=color:#fe8019>.</span>swap(qubit, n <span style=color:#fe8019>-</span> qubit <span style=color:#fe8019>-</span> <span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> j <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(n):
</span></span><span style=display:flex><span>        <span style=color:#fe8019>for</span> m <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(j):
</span></span><span style=display:flex><span>            qc<span style=color:#fe8019>.</span>cp(<span style=color:#fe8019>-</span>np<span style=color:#fe8019>.</span>pi <span style=color:#fe8019>/</span> <span style=color:#fabd2f>float</span>(<span style=color:#d3869b>2</span> <span style=color:#fe8019>**</span> (j <span style=color:#fe8019>-</span> m)), m, j)
</span></span><span style=display:flex><span>        qc<span style=color:#fe8019>.</span>h(j)
</span></span><span style=display:flex><span>    qc<span style=color:#fe8019>.</span>name <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;IQFT&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> qc
</span></span></code></pre></td></tr></table></div></div><h2 id=qpe class="article-heading serif">QPE
<a class="headline-hash smoothScroll hover-show scrollspy" href=#qpe><i class="fas fa-hashtag fa-xs"></i></a></h2><p>將上述電路合併在一起。</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-59>59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-60>60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-61>61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-62>62</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>qpe_circ</span>(g):
</span></span><span style=display:flex><span>    qc <span style=color:#fe8019>=</span> QuantumCircuit(<span style=color:#d3869b>4</span> <span style=color:#fe8019>+</span> CBIT_NUM, CBIT_NUM)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> q <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(CBIT_NUM):
</span></span><span style=display:flex><span>        qc<span style=color:#fe8019>.</span>h(q)  <span style=color:#928374;font-style:italic># Initialize counting qubits in state |+&gt;</span>
</span></span><span style=display:flex><span>    qc<span style=color:#fe8019>.</span>x(<span style=color:#d3869b>0</span> <span style=color:#fe8019>+</span> CBIT_NUM)  <span style=color:#928374;font-style:italic># And auxiliary register in state |1&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> q <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(CBIT_NUM):  <span style=color:#928374;font-style:italic># Do controlled-U operations</span>
</span></span><span style=display:flex><span>        qc<span style=color:#fe8019>.</span>append(
</span></span><span style=display:flex><span>            gmod15_circ(g, <span style=color:#d3869b>2</span><span style=color:#fe8019>**</span>q), [q] <span style=color:#fe8019>+</span> [i <span style=color:#fe8019>+</span> CBIT_NUM <span style=color:#fe8019>for</span> i <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(<span style=color:#d3869b>4</span>)]
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>    qc<span style=color:#fe8019>.</span>append(iqft_circ(CBIT_NUM), <span style=color:#fabd2f>range</span>(CBIT_NUM))  <span style=color:#928374;font-style:italic># Do inverse-QFT</span>
</span></span><span style=display:flex><span>    qc<span style=color:#fe8019>.</span>measure(<span style=color:#fabd2f>range</span>(CBIT_NUM), <span style=color:#fabd2f>range</span>(CBIT_NUM))
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> qc
</span></span></code></pre></td></tr></table></div></div><h2 id=轉譯電路-transpile class="article-heading serif">轉譯電路 Transpile
<a class="headline-hash smoothScroll hover-show scrollspy" href=#%e8%bd%89%e8%ad%af%e9%9b%bb%e8%b7%af-transpile><i class="fas fa-hashtag fa-xs"></i></a></h2><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-114>114</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#928374;font-style:italic># Assign the backend</span>
</span></span><span style=display:flex><span>backend <span style=color:#fe8019>=</span> Aer<span style=color:#fe8019>.</span>get_backend(<span style=color:#b8bb26>&#34;aer_simulator&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic># Build circuit</span>
</span></span><span style=display:flex><span>qc <span style=color:#fe8019>=</span> qpe_circ(g)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic># Transpile circuit</span>
</span></span><span style=display:flex><span>t_qc <span style=color:#fe8019>=</span> transpile(qc, backend)
</span></span><span style=display:flex><span>t_qc<span style=color:#fe8019>.</span>metadata <span style=color:#fe8019>=</span> {<span style=color:#b8bb26>&#34;backend&#34;</span>: backend}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic># Circuit visualization</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>print</span>(qc<span style=color:#fe8019>.</span>draw(fold<span style=color:#fe8019>=-</span><span style=color:#d3869b>1</span>, output<span style=color:#fe8019>=</span><span style=color:#b8bb26>&#34;text&#34;</span>))
</span></span></code></pre></td></tr></table></div></div><h2 id=執行電路 class="article-heading serif">執行電路
<a class="headline-hash smoothScroll hover-show scrollspy" href=#%e5%9f%b7%e8%a1%8c%e9%9b%bb%e8%b7%af><i class="fas fa-hashtag fa-xs"></i></a></h2><p>要執行一個量子電路需要先進行 <code>assemble</code> (將資訊打包並產生 task ID) 接著再使用對應的 backend 執行。執行過一次 QPE (如下方程式碼) 算一次 Attempt。可以看到每個 Attempt 只用到一個 shot。若是用 1024 shot 統計可以發現 counting bit 只會出現四種結果 (&lsquo;0000&rsquo;, &lsquo;0100&rsquo;, &lsquo;1000&rsquo;, &lsquo;1100&rsquo;)。</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-63>63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-64>64</a>
</span><span style=background-color:#3d3d3d><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-65>65</a>
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-66>66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-67>67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-68>68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-69>69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-70>70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-71>71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-72>72</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>run_qpe</span>(t_qc):
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic># Simulate Results</span>
</span></span><span style=display:flex;background-color:#3d3d3d><span>    qobj <span style=color:#fe8019>=</span> assemble(t_qc, shots<span style=color:#fe8019>=</span><span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic># Setting memory=True below allows us to see a list of each sequential reading</span>
</span></span><span style=display:flex><span>    result <span style=color:#fe8019>=</span> t_qc<span style=color:#fe8019>.</span>metadata[<span style=color:#b8bb26>&#34;backend&#34;</span>]<span style=color:#fe8019>.</span>run(qobj, memory<span style=color:#fe8019>=</span><span style=color:#fe8019>True</span>)<span style=color:#fe8019>.</span>result()
</span></span><span style=display:flex><span>    readings <span style=color:#fe8019>=</span> result<span style=color:#fe8019>.</span>get_memory()
</span></span><span style=display:flex><span>    <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Register Reading: &#34;</span> <span style=color:#fe8019>+</span> readings[<span style=color:#d3869b>0</span>])
</span></span><span style=display:flex><span>    phase <span style=color:#fe8019>=</span> <span style=color:#fabd2f>int</span>(readings[<span style=color:#d3869b>0</span>], <span style=color:#d3869b>2</span>) <span style=color:#fe8019>/</span> (<span style=color:#d3869b>2</span><span style=color:#fe8019>**</span>CBIT_NUM)
</span></span><span style=display:flex><span>    <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Corresponding Phase: </span><span style=color:#b8bb26>%f</span><span style=color:#b8bb26>&#34;</span> <span style=color:#fe8019>%</span> phase)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> phase
</span></span></code></pre></td></tr></table></div></div><p>運氣好只要一次 Attempt 就可以得到質因數結果，反之，要重複執行。因此會有一個迴圈去重複嘗試 <code>run_qpe</code> (第 81 行) 直到得到結果。</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-75>75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-76>76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-77>77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-78>78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-79>79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-80>80</a>
</span><span style=background-color:#3d3d3d><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-81>81</a>
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-82>82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-83>83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-84>84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-85>85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-86>86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-87>87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-88>88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-89>89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-90>90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-91>91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-92>92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-93>93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-94>94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-95>95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-96>96</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>solve</span>(t_qc, N, g):
</span></span><span style=display:flex><span>    factor_found <span style=color:#fe8019>=</span> <span style=color:#fe8019>False</span>
</span></span><span style=display:flex><span>    attempt <span style=color:#fe8019>=</span> <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>while</span> <span style=color:#fe8019>not</span> factor_found:
</span></span><span style=display:flex><span>        attempt <span style=color:#fe8019>+=</span> <span style=color:#d3869b>1</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;</span><span style=color:#b8bb26>\n</span><span style=color:#b8bb26>Attempt </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26>:&#34;</span> <span style=color:#fe8019>%</span> attempt)
</span></span><span style=display:flex;background-color:#3d3d3d><span>        phase <span style=color:#fe8019>=</span> run_qpe(t_qc)  <span style=color:#928374;font-style:italic># Phase = s/r</span>
</span></span><span style=display:flex><span>        frac <span style=color:#fe8019>=</span> Fraction(phase)<span style=color:#fe8019>.</span>limit_denominator(
</span></span><span style=display:flex><span>            N
</span></span><span style=display:flex><span>        )  <span style=color:#928374;font-style:italic># Denominator should (hopefully!) tell us r</span>
</span></span><span style=display:flex><span>        r <span style=color:#fe8019>=</span> frac<span style=color:#fe8019>.</span>denominator
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Result: r = </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26>&#34;</span> <span style=color:#fe8019>%</span> r)
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> phase <span style=color:#fe8019>!=</span> <span style=color:#d3869b>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#928374;font-style:italic># Guesses for factors are gcd(x^{r/2} ±1 , 15)</span>
</span></span><span style=display:flex><span>            guesses <span style=color:#fe8019>=</span> [gcd(g <span style=color:#fe8019>**</span> (r <span style=color:#fe8019>//</span> <span style=color:#d3869b>2</span>) <span style=color:#fe8019>-</span> <span style=color:#d3869b>1</span>, N), gcd(g <span style=color:#fe8019>**</span> (r <span style=color:#fe8019>//</span> <span style=color:#d3869b>2</span>) <span style=color:#fe8019>+</span> <span style=color:#d3869b>1</span>, N)]
</span></span><span style=display:flex><span>            <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Guessed Factors: </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26> and </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26>&#34;</span> <span style=color:#fe8019>%</span> (guesses[<span style=color:#d3869b>0</span>], guesses[<span style=color:#d3869b>1</span>]))
</span></span><span style=display:flex><span>            <span style=color:#fe8019>for</span> guess <span style=color:#fe8019>in</span> guesses:
</span></span><span style=display:flex><span>                <span style=color:#fe8019>if</span> (
</span></span><span style=display:flex><span>                    guess <span style=color:#fe8019>not</span> <span style=color:#fe8019>in</span> [<span style=color:#d3869b>1</span>, N] <span style=color:#fe8019>and</span> (N <span style=color:#fe8019>%</span> guess) <span style=color:#fe8019>==</span> <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>                ):  <span style=color:#928374;font-style:italic># Check to see if guess is a factor</span>
</span></span><span style=display:flex><span>                    <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;*** Non-trivial factor found: </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26> ***&#34;</span> <span style=color:#fe8019>%</span> guess)
</span></span><span style=display:flex><span>                    factor_found <span style=color:#fe8019>=</span> <span style=color:#fe8019>True</span>
</span></span></code></pre></td></tr></table></div></div><p><details><summary><span>展開查看完整程式碼</span></summary><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2>  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3>  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4>  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5>  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6>  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7>  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8>  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9>  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-10> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-13> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-14> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-15> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-16> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-17> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-18> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-19> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-20> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-21> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-22> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-23> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-24> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-25> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-26> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-27> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-28> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-29> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-30> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-31> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-32> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-33> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-34> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-35> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-36> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-37> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-38> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-39> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-40> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-41> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-42> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-43> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-44> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-45> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-46> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-47> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-48> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-49> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-50> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-51> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-52> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-53> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-54> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-55> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-56> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-57> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-58> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-59> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-60> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-61> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-62> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-63> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-64> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-65> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-66> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-67> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-68> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-69> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-70> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-71> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-72> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-73> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-74> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-75> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-76> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-77> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-78> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-79> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-80> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-81> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-82> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-83> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-84> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-85> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-86> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-87> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-88> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-89> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-90> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-91> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-92> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-93> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-94> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-95> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-96> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-97><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-97> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-98><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-98> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-99><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-99> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-100><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-100>100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-101><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-101>101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-102><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-102>102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-114>114</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-115><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-115>115</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-116><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-116>116</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-117><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-117>117</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-118><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-118>118</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-119><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-119>119</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-120><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-120>120</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fe8019>import</span> numpy <span style=color:#fe8019>as</span> np
</span></span><span style=display:flex><span><span style=color:#fe8019>from</span> qiskit <span style=color:#fe8019>import</span> QuantumCircuit, Aer, transpile, assemble
</span></span><span style=display:flex><span><span style=color:#fe8019>from</span> qiskit.converters <span style=color:#fe8019>import</span> circuit_to_dag
</span></span><span style=display:flex><span><span style=color:#fe8019>from</span> math <span style=color:#fe8019>import</span> gcd, log2
</span></span><span style=display:flex><span><span style=color:#fe8019>from</span> fractions <span style=color:#fe8019>import</span> Fraction
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Imports Successful&#34;</span>)
</span></span><span style=display:flex><span>CBIT_NUM <span style=color:#fe8019>=</span> <span style=color:#d3869b>4</span>  <span style=color:#928374;font-style:italic># The number of counting bits</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>gmod15_circ</span>(g, power):
</span></span><span style=display:flex><span>    <span style=color:#b8bb26>&#34;&#34;&#34;Controlled multiplication by g mod 15&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>if</span> g <span style=color:#fe8019>not</span> <span style=color:#fe8019>in</span> [<span style=color:#d3869b>2</span>, <span style=color:#d3869b>4</span>, <span style=color:#d3869b>7</span>, <span style=color:#d3869b>8</span>, <span style=color:#d3869b>11</span>, <span style=color:#d3869b>13</span>]:
</span></span><span style=display:flex><span>        <span style=color:#fe8019>raise</span> <span style=color:#fb4934>ValueError</span>(<span style=color:#b8bb26>&#34;&#39;g&#39; must be 2,4,7,8,11 or 13&#34;</span>)
</span></span><span style=display:flex><span>    U <span style=color:#fe8019>=</span> QuantumCircuit(<span style=color:#d3869b>4</span>)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> _ <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(power):
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> g <span style=color:#fe8019>in</span> [<span style=color:#d3869b>2</span>, <span style=color:#d3869b>13</span>]:
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>0</span>, <span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>1</span>, <span style=color:#d3869b>2</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>2</span>, <span style=color:#d3869b>3</span>)
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> g <span style=color:#fe8019>in</span> [<span style=color:#d3869b>7</span>, <span style=color:#d3869b>8</span>]:
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>2</span>, <span style=color:#d3869b>3</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>1</span>, <span style=color:#d3869b>2</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>0</span>, <span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> g <span style=color:#fe8019>in</span> [<span style=color:#d3869b>4</span>, <span style=color:#d3869b>11</span>]:
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>1</span>, <span style=color:#d3869b>3</span>)
</span></span><span style=display:flex><span>            U<span style=color:#fe8019>.</span>swap(<span style=color:#d3869b>0</span>, <span style=color:#d3869b>2</span>)
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> g <span style=color:#fe8019>in</span> [<span style=color:#d3869b>7</span>, <span style=color:#d3869b>11</span>, <span style=color:#d3869b>13</span>]:
</span></span><span style=display:flex><span>            <span style=color:#fe8019>for</span> q <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(<span style=color:#d3869b>4</span>):
</span></span><span style=display:flex><span>                U<span style=color:#fe8019>.</span>x(q)
</span></span><span style=display:flex><span>    U <span style=color:#fe8019>=</span> U<span style=color:#fe8019>.</span>reverse_bits()  <span style=color:#928374;font-style:italic># reversed because IBM uses Big endian for U</span>
</span></span><span style=display:flex><span>    U <span style=color:#fe8019>=</span> U<span style=color:#fe8019>.</span>to_gate()
</span></span><span style=display:flex><span>    U<span style=color:#fe8019>.</span>name <span style=color:#fe8019>=</span> <span style=color:#b8bb26>f</span><span style=color:#b8bb26>&#34;</span><span style=color:#b8bb26>{</span>g<span style=color:#b8bb26>}</span><span style=color:#b8bb26>^</span><span style=color:#b8bb26>{{</span><span style=color:#b8bb26>2^</span><span style=color:#b8bb26>{</span>log2(power)<span style=color:#b8bb26>:</span><span style=color:#b8bb26>.0f</span><span style=color:#b8bb26>}}</span><span style=color:#b8bb26>}</span><span style=color:#b8bb26> mod 15&#34;</span>
</span></span><span style=display:flex><span>    c_U <span style=color:#fe8019>=</span> U<span style=color:#fe8019>.</span>control()
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> c_U
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>iqft_circ</span>(n):
</span></span><span style=display:flex><span>    <span style=color:#b8bb26>&#34;&#34;&#34;n-qubit QFTdagger (IQFT) the first n qubits in circ&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    qc <span style=color:#fe8019>=</span> QuantumCircuit(n)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> qubit <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(n <span style=color:#fe8019>//</span> <span style=color:#d3869b>2</span>):
</span></span><span style=display:flex><span>        qc<span style=color:#fe8019>.</span>swap(qubit, n <span style=color:#fe8019>-</span> qubit <span style=color:#fe8019>-</span> <span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> j <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(n):
</span></span><span style=display:flex><span>        <span style=color:#fe8019>for</span> m <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(j):
</span></span><span style=display:flex><span>            qc<span style=color:#fe8019>.</span>cp(<span style=color:#fe8019>-</span>np<span style=color:#fe8019>.</span>pi <span style=color:#fe8019>/</span> <span style=color:#fabd2f>float</span>(<span style=color:#d3869b>2</span> <span style=color:#fe8019>**</span> (j <span style=color:#fe8019>-</span> m)), m, j)
</span></span><span style=display:flex><span>        qc<span style=color:#fe8019>.</span>h(j)
</span></span><span style=display:flex><span>    qc<span style=color:#fe8019>.</span>name <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;IQFT&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> qc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>qpe_circ</span>(g):
</span></span><span style=display:flex><span>    qc <span style=color:#fe8019>=</span> QuantumCircuit(<span style=color:#d3869b>4</span> <span style=color:#fe8019>+</span> CBIT_NUM, CBIT_NUM)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> q <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(CBIT_NUM):
</span></span><span style=display:flex><span>        qc<span style=color:#fe8019>.</span>h(q)  <span style=color:#928374;font-style:italic># Initialize counting qubits in state |+&gt;</span>
</span></span><span style=display:flex><span>    qc<span style=color:#fe8019>.</span>x(<span style=color:#d3869b>0</span> <span style=color:#fe8019>+</span> CBIT_NUM)  <span style=color:#928374;font-style:italic># And auxiliary register in state |1&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>for</span> q <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(CBIT_NUM):  <span style=color:#928374;font-style:italic># Do controlled-U operations</span>
</span></span><span style=display:flex><span>        qc<span style=color:#fe8019>.</span>append(gmod15_circ(g, <span style=color:#d3869b>2</span><span style=color:#fe8019>**</span>q), [q] <span style=color:#fe8019>+</span> [i <span style=color:#fe8019>+</span> CBIT_NUM <span style=color:#fe8019>for</span> i <span style=color:#fe8019>in</span> <span style=color:#fabd2f>range</span>(<span style=color:#d3869b>4</span>)])
</span></span><span style=display:flex><span>    qc<span style=color:#fe8019>.</span>append(iqft_circ(CBIT_NUM), <span style=color:#fabd2f>range</span>(CBIT_NUM))  <span style=color:#928374;font-style:italic># Do inverse-QFT</span>
</span></span><span style=display:flex><span>    qc<span style=color:#fe8019>.</span>measure(<span style=color:#fabd2f>range</span>(CBIT_NUM), <span style=color:#fabd2f>range</span>(CBIT_NUM))
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> qc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>run_qpe</span>(t_qc):
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic># Simulate Results</span>
</span></span><span style=display:flex><span>    qobj <span style=color:#fe8019>=</span> assemble(t_qc, shots<span style=color:#fe8019>=</span><span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic># Setting memory=True below allows us to see a list of each sequential reading</span>
</span></span><span style=display:flex><span>    result <span style=color:#fe8019>=</span> t_qc<span style=color:#fe8019>.</span>metadata[<span style=color:#b8bb26>&#34;backend&#34;</span>]<span style=color:#fe8019>.</span>run(qobj, memory<span style=color:#fe8019>=</span><span style=color:#fe8019>True</span>)<span style=color:#fe8019>.</span>result()
</span></span><span style=display:flex><span>    readings <span style=color:#fe8019>=</span> result<span style=color:#fe8019>.</span>get_memory()
</span></span><span style=display:flex><span>    <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Register Reading: &#34;</span> <span style=color:#fe8019>+</span> readings[<span style=color:#d3869b>0</span>])
</span></span><span style=display:flex><span>    phase <span style=color:#fe8019>=</span> <span style=color:#fabd2f>int</span>(readings[<span style=color:#d3869b>0</span>], <span style=color:#d3869b>2</span>) <span style=color:#fe8019>/</span> (<span style=color:#d3869b>2</span><span style=color:#fe8019>**</span>CBIT_NUM)
</span></span><span style=display:flex><span>    <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Corresponding Phase: </span><span style=color:#b8bb26>%f</span><span style=color:#b8bb26>&#34;</span> <span style=color:#fe8019>%</span> phase)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> phase
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>solve</span>(t_qc, N, g):
</span></span><span style=display:flex><span>    factor_found <span style=color:#fe8019>=</span> <span style=color:#fe8019>False</span>
</span></span><span style=display:flex><span>    attempt <span style=color:#fe8019>=</span> <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>while</span> <span style=color:#fe8019>not</span> factor_found:
</span></span><span style=display:flex><span>        attempt <span style=color:#fe8019>+=</span> <span style=color:#d3869b>1</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;</span><span style=color:#b8bb26>\n</span><span style=color:#b8bb26>Attempt </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26>:&#34;</span> <span style=color:#fe8019>%</span> attempt)
</span></span><span style=display:flex><span>        phase <span style=color:#fe8019>=</span> run_qpe(t_qc)  <span style=color:#928374;font-style:italic># Phase = s/r</span>
</span></span><span style=display:flex><span>        frac <span style=color:#fe8019>=</span> Fraction(phase)<span style=color:#fe8019>.</span>limit_denominator(
</span></span><span style=display:flex><span>            N
</span></span><span style=display:flex><span>        )  <span style=color:#928374;font-style:italic># Denominator should (hopefully!) tell us r</span>
</span></span><span style=display:flex><span>        r <span style=color:#fe8019>=</span> frac<span style=color:#fe8019>.</span>denominator
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Result: r = </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26>&#34;</span> <span style=color:#fe8019>%</span> r)
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> phase <span style=color:#fe8019>!=</span> <span style=color:#d3869b>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#928374;font-style:italic># Guesses for factors are gcd(x^{r/2} ±1 , 15)</span>
</span></span><span style=display:flex><span>            guesses <span style=color:#fe8019>=</span> [gcd(g <span style=color:#fe8019>**</span> (r <span style=color:#fe8019>//</span> <span style=color:#d3869b>2</span>) <span style=color:#fe8019>-</span> <span style=color:#d3869b>1</span>, N), gcd(g <span style=color:#fe8019>**</span> (r <span style=color:#fe8019>//</span> <span style=color:#d3869b>2</span>) <span style=color:#fe8019>+</span> <span style=color:#d3869b>1</span>, N)]
</span></span><span style=display:flex><span>            <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;Guessed Factors: </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26> and </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26>&#34;</span> <span style=color:#fe8019>%</span> (guesses[<span style=color:#d3869b>0</span>], guesses[<span style=color:#d3869b>1</span>]))
</span></span><span style=display:flex><span>            <span style=color:#fe8019>for</span> guess <span style=color:#fe8019>in</span> guesses:
</span></span><span style=display:flex><span>                <span style=color:#fe8019>if</span> (
</span></span><span style=display:flex><span>                    guess <span style=color:#fe8019>not</span> <span style=color:#fe8019>in</span> [<span style=color:#d3869b>1</span>, N] <span style=color:#fe8019>and</span> (N <span style=color:#fe8019>%</span> guess) <span style=color:#fe8019>==</span> <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>                ):  <span style=color:#928374;font-style:italic># Check to see if guess is a factor</span>
</span></span><span style=display:flex><span>                    <span style=color:#fabd2f>print</span>(<span style=color:#b8bb26>&#34;*** Non-trivial factor found: </span><span style=color:#b8bb26>%i</span><span style=color:#b8bb26> ***&#34;</span> <span style=color:#fe8019>%</span> guess)
</span></span><span style=display:flex><span>                    factor_found <span style=color:#fe8019>=</span> <span style=color:#fe8019>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>main</span>():
</span></span><span style=display:flex><span>    N <span style=color:#fe8019>=</span> <span style=color:#d3869b>15</span>
</span></span><span style=display:flex><span>    g <span style=color:#fe8019>=</span> <span style=color:#d3869b>7</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic># Assign the backend</span>
</span></span><span style=display:flex><span>    backend <span style=color:#fe8019>=</span> Aer<span style=color:#fe8019>.</span>get_backend(<span style=color:#b8bb26>&#34;aer_simulator&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic># Build circuit</span>
</span></span><span style=display:flex><span>    qc <span style=color:#fe8019>=</span> qpe_circ(g)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic># Transpile circuit</span>
</span></span><span style=display:flex><span>    t_qc <span style=color:#fe8019>=</span> transpile(qc, backend)
</span></span><span style=display:flex><span>    t_qc<span style=color:#fe8019>.</span>metadata <span style=color:#fe8019>=</span> {<span style=color:#b8bb26>&#34;backend&#34;</span>: backend}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic># Circuit visualization</span>
</span></span><span style=display:flex><span>    <span style=color:#fabd2f>print</span>(qc<span style=color:#fe8019>.</span>draw(fold<span style=color:#fe8019>=-</span><span style=color:#d3869b>1</span>, output<span style=color:#fe8019>=</span><span style=color:#b8bb26>&#34;text&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    solve(t_qc, N, g)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fe8019>if</span> __name__ <span style=color:#fe8019>==</span> <span style=color:#b8bb26>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></td></tr></table></div></div></details><br><details><summary><span>執行環境</span></summary><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-env data-lang=env><span style=display:flex><span>$ cat /proc/version
</span></span><span style=display:flex><span>Linux version 5.10.16.3-microsoft-standard-WSL2 <span style=color:#fe8019>(</span>oe-user@oe-host<span style=color:#fe8019>)</span> <span style=color:#fe8019>(</span>x86_64-msft-linux-gcc <span style=color:#fe8019>(</span>GCC<span style=color:#fe8019>)</span> 9.3.0, GNU ld <span style=color:#fe8019>(</span>GNU Binutils<span style=color:#fe8019>)</span> 2.34.0.20200220<span style=color:#fe8019>)</span> <span style=color:#928374;font-style:italic>#1 SMP Fri Apr 2 22:23:49 UTC 2021</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ uname -a
</span></span><span style=display:flex><span>Linux DESKTOP-M72RH5C 5.10.16.3-microsoft-standard-WSL2 <span style=color:#928374;font-style:italic>#1 SMP Fri Apr 2 22:23:49 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ python --version
</span></span><span style=display:flex><span>Python 3.8.10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ pip list
</span></span><span style=display:flex><span>Package              Version
</span></span><span style=display:flex><span>-------------------- -----------
</span></span><span style=display:flex><span>certifi              2022.5.18.1
</span></span><span style=display:flex><span>cffi                 1.15.0
</span></span><span style=display:flex><span>charset-normalizer   2.0.12
</span></span><span style=display:flex><span>click                8.1.3
</span></span><span style=display:flex><span>cryptography         37.0.2
</span></span><span style=display:flex><span>Deprecated           1.2.13
</span></span><span style=display:flex><span>dill                 0.3.5.1
</span></span><span style=display:flex><span>idna                 3.3
</span></span><span style=display:flex><span>mpmath               1.2.1
</span></span><span style=display:flex><span>networkx             2.8.3
</span></span><span style=display:flex><span>ntlm-auth            1.5.0
</span></span><span style=display:flex><span>numpy                1.22.4
</span></span><span style=display:flex><span>pbr                  5.9.0
</span></span><span style=display:flex><span>pip                  20.0.2
</span></span><span style=display:flex><span>pkg-resources        0.0.0
</span></span><span style=display:flex><span>ply                  3.11
</span></span><span style=display:flex><span>psutil               5.9.1
</span></span><span style=display:flex><span>pycparser            2.21
</span></span><span style=display:flex><span>python-constraint    1.4.0
</span></span><span style=display:flex><span>python-dateutil      2.8.2
</span></span><span style=display:flex><span>python-tsp           0.2.1
</span></span><span style=display:flex><span>qiskit               0.36.2
</span></span><span style=display:flex><span>qiskit-aer           0.10.4
</span></span><span style=display:flex><span>qiskit-ibmq-provider 0.19.1
</span></span><span style=display:flex><span>qiskit-ignis         0.7.1
</span></span><span style=display:flex><span>qiskit-terra         0.20.2
</span></span><span style=display:flex><span>requests             2.27.1
</span></span><span style=display:flex><span>requests-ntlm        1.1.0
</span></span><span style=display:flex><span>retworkx             0.11.0
</span></span><span style=display:flex><span>scipy                1.8.1
</span></span><span style=display:flex><span>setuptools           44.0.0
</span></span><span style=display:flex><span>six                  1.16.0
</span></span><span style=display:flex><span>stevedore            3.5.0
</span></span><span style=display:flex><span>symengine            0.9.2
</span></span><span style=display:flex><span>sympy                1.10.1
</span></span><span style=display:flex><span>tabulate             0.8.9
</span></span><span style=display:flex><span>tsplib95             0.7.1
</span></span><span style=display:flex><span>tweedledum           1.1.1
</span></span><span style=display:flex><span>urllib3              1.26.9
</span></span><span style=display:flex><span>websocket-client     1.3.2
</span></span><span style=display:flex><span>websockets           10.3
</span></span><span style=display:flex><span>wheel                0.34.2
</span></span><span style=display:flex><span>wrapt                1.14.1
</span></span></code></pre></div></details></p><h2 id=執行結果 class="article-heading serif">執行結果
<a class="headline-hash smoothScroll hover-show scrollspy" href=#%e5%9f%b7%e8%a1%8c%e7%b5%90%e6%9e%9c><i class="fas fa-hashtag fa-xs"></i></a></h2><ul><li>運氣較好:</li></ul><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Attempt 1:
</span></span><span style=display:flex><span>Register Reading: 0100
</span></span><span style=display:flex><span>Corresponding Phase: 0.250000
</span></span><span style=display:flex><span>Result: r = 4
</span></span><span style=display:flex><span>Guessed Factors: 3 and 5
</span></span><span style=display:flex><span>*** Non-trivial factor found: 3 ***
</span></span><span style=display:flex><span>*** Non-trivial factor found: 5 ***
</span></span></code></pre></div><ul><li>運氣較差:</li></ul><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Attempt 1:
</span></span><span style=display:flex><span>Register Reading: 0000
</span></span><span style=display:flex><span>Corresponding Phase: 0.000000
</span></span><span style=display:flex><span>Result: r = 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Attempt 2:
</span></span><span style=display:flex><span>Register Reading: 0000
</span></span><span style=display:flex><span>Corresponding Phase: 0.000000
</span></span><span style=display:flex><span>Result: r = 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Attempt 3:
</span></span><span style=display:flex><span>Register Reading: 0000
</span></span><span style=display:flex><span>Corresponding Phase: 0.000000
</span></span><span style=display:flex><span>Result: r = 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Attempt 4:
</span></span><span style=display:flex><span>Register Reading: 1000
</span></span><span style=display:flex><span>Corresponding Phase: 0.500000
</span></span><span style=display:flex><span>Result: r = 2
</span></span><span style=display:flex><span>Guessed Factors: 3 and 1
</span></span><span style=display:flex><span>*** Non-trivial factor found: 3 ***
</span></span></code></pre></div><h1 id=結語 class="article-heading serif">結語
<a class="headline-hash smoothScroll hover-show scrollspy" href=#%e7%b5%90%e8%aa%9e><i class="fas fa-hashtag fa-xs"></i></a></h1><p>有些部分還是不能完全理解。尤其是 $U$ 的理論及實作，這裡留下一些我個人的疑問等待後續找到答案:</p><ul><li>$\mu$ 的部分，輸出似乎不是 $\mu$ 本身，而是四種狀態 (1, 4, 7, 13) 隨機出現。</li><li>無法直觀看出 QPE 中 phase kickback 的影響。</li></ul><p>上述兩點已解決，請參考 <a href=/posts/20220630-shor-algorithm-part2/>Shor's Algorithm Part2</a>。</p><h1 id=references class="article-heading serif">References
<a class="headline-hash smoothScroll hover-show scrollspy" href=#references><i class="fas fa-hashtag fa-xs"></i></a></h1><ul><li><a href=https://en.wikipedia.org/wiki/RSA_%28cryptosystem%29 title="RSA (cryptosystem) - wiki" aria-label="RSA (cryptosystem) - wiki" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> RSA (cryptosystem) - wiki</a></li><li><a href="https://www.youtube.com/watch?v=lvTqbM5Dq4Q" title="How Quantum Computers Break Encryption | Shor&rsquo;s Algorithm Explained - minutephysics youtube" aria-label="How Quantum Computers Break Encryption | Shor&rsquo;s Algorithm Explained - minutephysics youtube" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> How Quantum Computers Break Encryption | Shor&rsquo;s Algorithm Explained - minutephysics youtube</a></li><li><a href=https://en.wikipedia.org/wiki/Shor%27s_algorithm title="Shor&rsquo;s algorithm - wiki" aria-label="Shor&rsquo;s algorithm - wiki" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> Shor&rsquo;s algorithm - wiki</a></li><li><a href=https://qiskit.org/textbook/ch-algorithms/shor.html title="Shor&rsquo;s Algorithm - IBM" aria-label="Shor&rsquo;s Algorithm - IBM" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> Shor&rsquo;s Algorithm - IBM</a></li><li><a href=https://jonathan-hui.medium.com/qc-period-finding-in-shors-algorithm-7eb0c22e8202 title="QC — Period finding in Shor’s Algorithm - Jonathan Hui" aria-label="QC — Period finding in Shor’s Algorithm - Jonathan Hui" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> QC — Period finding in Shor’s Algorithm - Jonathan Hui</a></li><li><a href=https://github.com/Qiskit/qiskit-aer/issues/585 title="The seed_simulator doesn&rsquo;t work for list of circuits #585" aria-label="The seed_simulator doesn&rsquo;t work for list of circuits #585" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> The seed_simulator doesn&rsquo;t work for list of circuits #585</a></li><li><a href=https://sharkyspool.home.blog/2019/08/02/large-integer-factorization-number-field-sieve-vs-shor/ title="Large Integer Factorization: Number Field Sieve vs Shor - Vladimir Silva" aria-label="Large Integer Factorization: Number Field Sieve vs Shor - Vladimir Silva" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> Large Integer Factorization: Number Field Sieve vs Shor - Vladimir Silva</a></li></ul><div class=footnotes role=doc-endnotes><h1 id=footnotes class="article-heading serif">Footnotes
<a class="headline-hash smoothScroll hover-show scrollspy" style=color:#000 href=#footnotes><i class="fas fa-hashtag fa-xs"></i></a><style>#footnotes::before{content:none}</style></h1><ol><li id=fn:1><p><a href=https://en.wikipedia.org/wiki/Fredkin_gate title="Fredkin gate" aria-label="Fredkin gate" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> Fredkin gate</a>&#160;<sup><a href=#fnref:1 class="smoothScroll footnote-backref no-underline-on-hover" role=doc-backlink>&#8617;&#xfe0e;</a></sup></p></li><li id=fn:2><p><a href=https://en.wikipedia.org/wiki/Toffoli_gate title="Toffoli gate" aria-label="Toffoli gate" target=_blank rel="noreferrer noopener"><i class="fas fa-external-link-square-alt"></i> Toffoli gate</a>&#160;<sup><a href=#fnref:2 class="smoothScroll footnote-backref no-underline-on-hover" role=doc-backlink>&#8617;&#xfe0e;</a></sup></p></li></ol></div><div class=footer><div class="column center tc"><div id=license-block><dl style=font-size:80%><dt class=license>Author:</dt><dd class=license>Huang, Po-Hsuan 黃柏瑄 (aben20807)</dd><dt class=license>Last modified:</dt><dd class=license>Mar 3, 2025</dd><dt class=license>License:</dt><dd class=license><a href=https://creativecommons.org/licenses/by/4.0/ target=_blank rel="noreferrer noopener">CC BY 4.0</a></dd><dt class=license>Link:</dt><dd class=license><span style=margin-right:.5rem>https://aben20807.github.io/posts/20220626-shor-algorithm/</span></dd></dl></div><div class=mb3><span class=tags-sm><a onclick=copyToClip() role=button class="no-underline no-underline-on-hover" title="Copy the license block" style=cursor:pointer!important;white-space:nowrap><i class="far fa-clipboard"></i> Copy license</a></span></div><script>function copyToClip(){let o=document.getElementById("license-block"),t=document.querySelectorAll("dt.license"),n=document.querySelectorAll("dd.license"),e=document.createElement("textarea");for(let s=0;s<t.length;s++)e.value+=t[s].textContent+" "+n[s].textContent,s<t.length-1&&(e.value+="; ");document.body.appendChild(e),e.select(),document.execCommand("Copy"),e.remove();const s=new XNotify("BottomLeft");s.info({borderRadius:"2px",content:"copied!",duration:3e3,background:"#646464"})}</script><div><script type=text/javascript>document.write("<iframe scrolling='no' frameborder='0' class='center' sandbox='allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-storage-access-by-user-activation' style='' src='https://button.like.co/in/embed/aben20807/button?referrer="+encodeURIComponent(location.href.split("?")[0].split("#")[0])+"'></iframe>")</script></div><div class="col tl" style=font-size:95%!important><div class="fl w-100"><a title="Prev: Quantum Phase Estimation" class="link-reverse fl w-100 truncate" href=https://aben20807.github.io/posts/20220623-quantum-phase-estimation/><i class="fas fa-caret-square-up"></i> Quantum Phase Estimation<p class="footer-summary ml3 mb1">範例導向學習量子相位估計 (Quantum Phase Estimation)。</p></a></div><div class="fl w-100"><a title="Next: Shor's Algorithm Part2" class="link-reverse fl w-100 truncate" href=https://aben20807.github.io/posts/20220630-shor-algorithm-part2/><i class="fas fa-caret-square-down"></i> Shor's Algorithm Part2<p class="footer-summary ml3 mb1">追加一些深入探討，以及解決上一篇留下的疑問。</p></a></div><div class=mb2><div class="fl w-100"><a title="Related: Quantum Phase Estimation" class="link-reverse fl w-100 truncate" href=https://aben20807.github.io/posts/20220623-quantum-phase-estimation/><i class="fas fa-seedling"></i> Quantum Phase Estimation<p class="footer-summary ml3 mb1">範例導向學習量子相位估計 (Quantum Phase Estimation)。</p></a></div><div class="fl w-100"><a title="Related: Quantum Fourier Transform" class="link-reverse fl w-100 truncate" href=https://aben20807.github.io/posts/20220514-quantum-fourier-transform/><i class="fas fa-seedling"></i> Quantum Fourier Transform<p class="footer-summary ml3 mb1">有點感覺了，趕緊記錄。
量子傅立葉轉換 (Quantum Fourier Transform, QFT) 是在量子運算上實現離散傅立葉轉換 (Discrete Fourier Transform, DFT)。QFT 的存在是為了之後 shor 演算法1，不過本篇先專注討論 QFT。</p></a></div><div class="fl w-100"><a title="Related: 4-bit QFT IQFT" class="link-reverse fl w-100 truncate" href=https://aben20807.github.io/posts/20220620-4-bit-qft-iqft/><i class="fas fa-seedling"></i> 4-bit QFT IQFT<p class="footer-summary ml3 mb1">發現 IQFT 有其他的形式。</p></a></div></div></div></div><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//forrecording.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></div><div id=toc class="column col-2 hide-print"><div class="toc toc-nav toc-pills ml-0 col-3"><li class="nav-item pb-3 text-center"><span class="font-weight-bold mb-2 serif">- CATALOG -</span></li><div id=toc-scroll class="noselect hide-scrollbar"><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#%e7%9b%ae%e6%a8%99%e5%95%8f%e9%a1%8c>1.
目標問題</a></li></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#example-ref>1.1.
Example ref</a></li></ul></ul><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#several-lemmas-with-examples>2.
Several lemmas with examples</a></li></ul><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#solving-by-quantum>3.
Solving by Quantum</a></li></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#convert-to-u>3.1.
Convert to $U$</a></li></ul></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#eigenvector>3.2.
Eigenvector</a></li></ul></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#eigenvectors-superposition>3.3.
Eigenvectors superposition</a></li></ul></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#use-qpe-to-get-eigenvalue>3.4.
Use QPE to get eigenvalue</a></li></ul></ul><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#qiskit-implementation>4.
Qiskit implementation</a></li></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#u-circuit>4.1.
U circuit</a></li></ul></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#iqft>4.2.
IQFT</a></li></ul></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#qpe>4.3.
QPE</a></li></ul></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#%e8%bd%89%e8%ad%af%e9%9b%bb%e8%b7%af-transpile>4.4.
轉譯電路 Transpile</a></li></ul></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#%e5%9f%b7%e8%a1%8c%e9%9b%bb%e8%b7%af>4.5.
執行電路</a></li></ul></ul><ul class=toc><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#%e5%9f%b7%e8%a1%8c%e7%b5%90%e6%9e%9c>4.6.
執行結果</a></li></ul></ul><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#%e7%b5%90%e8%aa%9e>5.
結語</a></li></ul><ul class=toc><li class=toc-item><a class="toc-link smoothScroll" href=#references>6.
References</a></li></ul></div><ul class=toc><li class=toc-item><a class='goto pl1 toc-item' id=gotop>⊛ Back to top</a></li><li class=toc-item><a class='goto pl1 toc-item' id=gobottom>⊛ Go to bottom</a></li><script type=text/javascript>fetchInject(["https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"]).then(()=>{var e="https://cdnjs.cloudflare.com/ajax/libs/jquery-smooth-scroll/2.2.0/jquery.smooth-scroll.min.js";$.getScript(e,function(){$("#gotop").click(function(){$("html,body").animate({scrollTop:0},300,"swing",function(){$("a.toc-link").removeClass("active")})}),$("#gobottom").click(function(){$("html,body").animate({scrollTop:$(document).height()},300,"swing",function(){$("a.toc-link").removeClass("active")})})})})</script></ul></div></div></div></main><div id=gotop_btn class=center><i class="fas fa-chevron-up"></i></div><footer class="hide-print sans-serif f6 fw1 bg-black near-white bottom-0 w-100 pa3 db overflow-auto" role=contentinfo><p class="w-30 fr tr" style=font-size:.875rem!important>Made with Hugo and
<a class="no-underline no-underline-on-hover" href=https://github.com/aben20807/hugOuO target=_blank rel="noreferrer noopener">hugOuO</a></p><p class="w-30 near-white" style=margin:0;font-size:.875rem!important>&copy; 2019-2025 Huang, Po-Hsuan 黃柏瑄 (aben20807)</p><p class="w-30 near-white" style=margin:0;font-size:.875rem!important><a href=https://aben20807.github.io/disclaimer>免責聲明 (Disclaimer)</a></p></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js></script><script type=text/javascript src=https://aben20807.github.io/js/hugouo.js?1745934155 async></script><script type=text/javascript src=https://aben20807.github.io/js/x-notify.min.js async></script><script>fetchInject(["https://cdn.jsdelivr.net/npm/baffle@0.3.6/dist/baffle.min.js"]).then(()=>{baffle(document.querySelector("h1")).start().set({speed:70}).reveal(800,800)})</script><script>MathJax={startup:{requireMap:{AMSmath:"ams",AMSsymbols:"ams",AMScd:"amscd",HTML:"html",noErrors:"noerrors",noUndefined:"noundefined"}},tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"]],tags:"ams"},skipTags:["script","noscript","style","textarea","pre"],svg:{fontCache:"global",scale:1},chtml:{scale:1}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@4.0.0-beta.4/tex-mml-chtml.js></script><script type=text/javascript src=https://aben20807.github.io/js/zooming.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector("body"),t=document.querySelectorAll(".ov-for-img");new Zooming({bgColor:"rgb(0, 0, 0)",bgOpacity:"0.8",customSize:"200%",enableGrab:!1,onBeforeOpen:()=>{t.forEach(e=>e.classList.remove("overflow-x-scroll")),e.style.overflowX="visible"},onClose:()=>{t.forEach(e=>e.classList.add("overflow-x-scroll")),e.style.overflowX="hidden"}}).listen(".img-zoomable")})</script><script>document.fonts.load("12px Noto Sans TC").then(function(){const e=document.querySelector("body");e.style.fontFamily=`"Noto Sans TC", ${window.getComputedStyle(e).getPropertyValue("font-family")}`}),document.fonts.load("12px Noto Sans TC").then(function(){let e=document.querySelectorAll(".serif");e.forEach(e=>{e.style.fontFamily=`Alice, "Noto Sans TC", ${window.getComputedStyle(e).getPropertyValue("font-family")}`})})</script></body></html>